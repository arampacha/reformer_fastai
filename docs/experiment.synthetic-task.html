---

title: Synthetic task


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/10_experiment.synthetic-task.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/10_experiment.synthetic-task.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.text.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">reformer_fastai.transformer</span> <span class="kn">import</span> <span class="n">TransformerLM</span>
<span class="kn">from</span> <span class="nn">reformer_fastai.reformer</span> <span class="kn">import</span> <span class="n">ReformerLM</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-dataset">Create dataset<a class="anchor-link" href="#Create-dataset"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We want to create sequences of the form 0w0w, where w is a sequence of integeres between 1-127 of some lenght: eg. 08470847.
We create items on the fly instead of all items up front. We return a tuple to make the dataloader a bit easier to inspect.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">TwinSequence</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sl</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="nb">len</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">sl</span><span class="o">%</span><span class="k">2</span> == 0
        <span class="bp">self</span><span class="o">.</span><span class="n">sl</span> <span class="o">=</span> <span class="n">sl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">len</span> <span class="o">=</span> <span class="nb">len</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">128</span><span class="p">,(</span><span class="bp">self</span><span class="o">.</span><span class="n">sl</span><span class="o">//</span><span class="mi">2</span><span class="p">,))</span>             <span class="c1"># w: [1-127] of len sl//2</span>
        <span class="n">seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>                                           <span class="c1"># seq = 0w</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">seq</span><span class="p">,</span><span class="n">seq</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>                       <span class="c1"># seq = 0w0w</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">seq</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">])),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># return offset target x:[0123], y:[1230]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>                     
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">len</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">from_dsets</span><span class="p">(</span><span class="n">TwinSequence</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">bs</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
<span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">xb</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">yb</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([6, 10]), torch.Size([6, 10]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that the final target item is a padded 0. But that should also be predicitable from the first part of the input sequence:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">yb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([0, 127, 7, 35, 15, 0, 127, 7, 35, 15],
 [127, 7, 35, 15, 0, 127, 7, 35, 15, 0])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The number of batches in train data loader (<code>n_iter</code> in fastai lingo): The reformer paper mentions 150 k steps. One step is one iteration/batches.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>8</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Target-masking">Target masking<a class="anchor-link" href="#Target-masking"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have to mask the <strong>first half</strong> of the targets. The first part is just random integers, so it's impossible to learn anything from it. We set the tokens in the first part to a special index, -100, and later tell our lossfunction to ignore items with this value. This means that the only task the model can learn is to copy the first part of the input sequence. If we didn't mask the first part, it would be penalized for poor performance in the first part, and would try to find a compromise.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">MaskTargCallback</span><span class="p">(</span><span class="n">Callback</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">before_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[:,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">train_ds</span><span class="o">.</span><span class="n">sl</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We create a custom accuracy that also disregards tokens with value -100:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">masked_accuracy</span><span class="p">(</span><span class="n">inp</span><span class="p">,</span> <span class="n">targ</span><span class="p">,</span> <span class="n">ignore</span><span class="o">=-</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">inp</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">targ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ignore</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">pred</span><span class="p">[:,</span><span class="n">mask</span><span class="p">]</span> <span class="o">==</span> <span class="n">targ</span><span class="p">[:,</span><span class="n">mask</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">2</span><span class="p">,</span>   <span class="mi">3</span><span class="p">,</span>   <span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">55</span><span class="p">])[</span><span class="kc">None</span><span class="p">,:]</span>
<span class="n">targ</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">])[</span><span class="kc">None</span><span class="p">,:]</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">targ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">100</span>
<span class="p">(</span><span class="n">pred</span><span class="p">[:,</span><span class="n">mask</span><span class="p">]</span> <span class="o">==</span> <span class="n">targ</span><span class="p">[:,</span><span class="n">mask</span><span class="p">])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.8000)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And finally a callback to inspect items directly before modelling:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Inspect_items</span><span class="p">(</span><span class="n">Callback</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">after_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">epoch</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">training</span><span class="p">:</span>
            <span class="n">inp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learn</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">targ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">learn</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">((</span><span class="n">inp</span><span class="p">,</span><span class="n">targ</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
            <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;inp&#39;</span><span class="p">,</span> <span class="s1">&#39;targ&#39;</span><span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Inspect-masking">Inspect masking<a class="anchor-link" href="#Inspect-masking"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's check what's actually going into the model with a tiny example:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs</span><span class="p">,</span> <span class="n">sl</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span><span class="mi">16</span>
<span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">train_sz</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">valid_sz</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">from_dsets</span><span class="p">(</span><span class="n">TwinSequence</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">train_sz</span><span class="p">),</span> <span class="n">TwinSequence</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">valid_sz</span><span class="p">),</span> <span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">TransformerLM</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">d_ff</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_seq_len</span><span class="o">=</span><span class="n">sl</span><span class="p">,</span> <span class="n">pos_enc</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">,</span>
                      <span class="n">attn_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ff_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">emb_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(</span><span class="n">ignore_index</span><span class="o">=-</span><span class="mi">100</span><span class="p">),</span> 
                <span class="n">metrics</span><span class="o">=</span><span class="n">masked_accuracy</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">MaskTargCallback</span><span class="p">(),</span> <span class="n">Inspect_items</span><span class="p">()])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>masked_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>4.659296</td>
      <td>4.568354</td>
      <td>0.125000</td>
      <td>00:02</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>    inp  targ
0     0  -100
1    52  -100
2    77  -100
3    44  -100
4   102  -100
5    87  -100
6   115  -100
7     2  -100
8     0    52
9    52    77
10   77    44
11   44   102
12  102    87
13   87   115
14  115     2
15    2     0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looks good!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Short-sequence-modelling">Short sequence modelling<a class="anchor-link" href="#Short-sequence-modelling"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we will test a short sequence to test that everything is working. We use the <a href="/reformer_fastai/transformer.html#TransformerLM"><code>TransformerLM</code></a> and compares it to the <a href="/reformer_fastai/reformer.html#ReformerLM"><code>ReformerLM</code></a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs</span><span class="p">,</span> <span class="n">sl</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span><span class="mi">64</span>
<span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">train_sz</span> <span class="o">=</span> <span class="mi">50_000</span>
<span class="n">valid_sz</span> <span class="o">=</span> <span class="mi">10_000</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">from_dsets</span><span class="p">(</span><span class="n">TwinSequence</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">train_sz</span><span class="p">),</span> <span class="n">TwinSequence</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">valid_sz</span><span class="p">),</span> <span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Total training steps:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="p">)</span><span class="o">*</span><span class="n">n_epochs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>781</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Transformer-LM---full-attention">Transformer LM - full attention<a class="anchor-link" href="#Transformer-LM---full-attention"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">TransformerLM</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">d_ff</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_seq_len</span><span class="o">=</span><span class="n">sl</span><span class="p">,</span> <span class="n">pos_enc</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">,</span>
                      <span class="n">attn_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ff_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">emb_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(</span><span class="n">ignore_index</span><span class="o">=-</span><span class="mi">100</span><span class="p">),</span> 
                <span class="n">metrics</span><span class="o">=</span><span class="n">masked_accuracy</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">MaskTargCallback</span><span class="p">()])</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>masked_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.002235</td>
      <td>0.002138</td>
      <td>0.999959</td>
      <td>00:18</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>The model fairly quickly learns the copy task, and reaches near 0 loss within a few hundred steps</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Test-inference-and-visualise-attention">Test inference and visualise attention<a class="anchor-link" href="#Test-inference-and-visualise-attention"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">train_ds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cuda</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span>
<span class="n">x</span><span class="p">[:,</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">:],</span> <span class="n">x</span><span class="p">[:,</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor([[  0,  52,  86,  12,  68,  40, 122,  83,  89,  56,   5,  94,  32,  34,
          112,  62, 126, 104,  51,  76,  52,  53,  65,   9,   5,  39,  83,  19,
           23,  16, 114,  13]], device=&#39;cuda:7&#39;),
 torch.Size([1, 32]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">store_attention</span><span class="p">()</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">preds</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)[:,</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span>
<span class="p">(</span><span class="n">preds</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">x</span><span class="p">[:,</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">:])</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(1., device=&#39;cuda:7&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">attn</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_attention_matrix</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have 4 heads in our transformer, and 1 attention matrix per head:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p><strong>The attention matrices shows us that mid way through the sequence the model starts paying attention to the first input sequence as expected. Each layers learns a bit different, but the combined output is good enough for perfect sequence copying. Note that there is no pattern to learn before this point, so the attention is just random noise. We also see that no token peeks ahead of it's own location, which we would expect from a language model with causal attention.</strong></p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">mat</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">attn</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">learn</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Reformer-LM---LSH-Attention">Reformer LM - LSH Attention<a class="anchor-link" href="#Reformer-LM---LSH-Attention"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Note!</strong> Sequence length <code>sl</code> needs to be divisible by <code>bucket_size</code>x2. So e.g. <code>sl=64</code> -&gt; <code>bucket_size=32</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_hashes</span><span class="o">=</span><span class="mi">4</span>
<span class="n">bucket_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="k">assert</span> <span class="n">sl</span> <span class="o">%</span> <span class="p">(</span><span class="n">bucket_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">ReformerLM</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">d_ff</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_seq_len</span><span class="o">=</span><span class="n">sl</span><span class="p">,</span><span class="n">attn_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                   <span class="n">ff_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bucket_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">n_hashes</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">causal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(</span><span class="n">ignore_index</span><span class="o">=-</span><span class="mi">100</span><span class="p">),</span> 
                <span class="n">metrics</span><span class="o">=</span><span class="n">masked_accuracy</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">MaskTargCallback</span><span class="p">()])</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>masked_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.000030</td>
      <td>0.000019</td>
      <td>1.000000</td>
      <td>01:32</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">learn</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Long-sequence-modelling">Long sequence modelling<a class="anchor-link" href="#Long-sequence-modelling"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Increase the sequence length to 1024, similar what is used in the paper.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs</span><span class="p">,</span> <span class="n">sl</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span><span class="mi">1024</span>
<span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">train_sz</span> <span class="o">=</span> <span class="mi">50_000</span>
<span class="n">valid_sz</span> <span class="o">=</span> <span class="mi">10_000</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">from_dsets</span><span class="p">(</span><span class="n">TwinSequence</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">train_sz</span><span class="p">),</span> <span class="n">TwinSequence</span><span class="p">(</span><span class="n">sl</span><span class="p">,</span> <span class="n">valid_sz</span><span class="p">),</span> <span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Total training steps:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="p">)</span><span class="o">*</span><span class="n">n_epochs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>15620</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Transformer-LM---full-attention">Transformer LM - full attention<a class="anchor-link" href="#Transformer-LM---full-attention"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">TransformerLM</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">d_ff</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_seq_len</span><span class="o">=</span><span class="n">sl</span><span class="p">,</span> <span class="n">pos_enc</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span><span class="p">,</span>
                      <span class="n">attn_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ff_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">emb_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(</span><span class="n">ignore_index</span><span class="o">=-</span><span class="mi">100</span><span class="p">),</span> 
                <span class="n">metrics</span><span class="o">=</span><span class="n">masked_accuracy</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">MaskTargCallback</span><span class="p">()])</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>masked_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>4.836012</td>
      <td>4.836038</td>
      <td>0.009833</td>
      <td>01:48</td>
    </tr>
    <tr>
      <td>1</td>
      <td>4.835448</td>
      <td>4.835324</td>
      <td>0.009910</td>
      <td>01:48</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.000208</td>
      <td>0.000165</td>
      <td>1.000000</td>
      <td>01:47</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.000783</td>
      <td>0.000659</td>
      <td>0.999871</td>
      <td>01:46</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.000323</td>
      <td>0.000338</td>
      <td>0.999937</td>
      <td>01:47</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.000117</td>
      <td>0.000128</td>
      <td>0.999979</td>
      <td>01:47</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.000017</td>
      <td>0.000022</td>
      <td>0.999997</td>
      <td>01:47</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.000004</td>
      <td>0.000004</td>
      <td>1.000000</td>
      <td>01:47</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.000003</td>
      <td>0.000003</td>
      <td>1.000000</td>
      <td>01:47</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.000003</td>
      <td>0.000003</td>
      <td>1.000000</td>
      <td>01:47</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">learn</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The model learns the task perfectly, similar to the result reported in the paper.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Reformer-LM---LSH-attention">Reformer LM - LSH attention<a class="anchor-link" href="#Reformer-LM---LSH-attention"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_hashes</span><span class="o">=</span><span class="mi">4</span>
<span class="n">bucket_size</span> <span class="o">=</span> <span class="mi">64</span>
<span class="k">assert</span> <span class="n">sl</span> <span class="o">%</span> <span class="p">(</span><span class="n">bucket_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">ReformerLM</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">d_ff</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_seq_len</span><span class="o">=</span><span class="n">sl</span><span class="p">,</span><span class="n">attn_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                   <span class="n">ff_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bucket_size</span><span class="o">=</span><span class="n">bucket_size</span><span class="p">,</span> <span class="n">n_hashes</span><span class="o">=</span><span class="n">n_hashes</span><span class="p">,</span> <span class="n">causal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(</span><span class="n">ignore_index</span><span class="o">=-</span><span class="mi">100</span><span class="p">),</span> 
                <span class="n">metrics</span><span class="o">=</span><span class="n">masked_accuracy</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">MaskTargCallback</span><span class="p">()])</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>masked_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>4.837234</td>
      <td>4.837356</td>
      <td>0.009842</td>
      <td>06:02</td>
    </tr>
    <tr>
      <td>1</td>
      <td>4.749002</td>
      <td>4.495837</td>
      <td>0.024876</td>
      <td>06:05</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.000360</td>
      <td>0.000029</td>
      <td>1.000000</td>
      <td>06:01</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.000003</td>
      <td>0.000039</td>
      <td>0.999992</td>
      <td>06:01</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.000001</td>
      <td>0.000001</td>
      <td>1.000000</td>
      <td>06:01</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.000031</td>
      <td>0.000003</td>
      <td>1.000000</td>
      <td>06:05</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.000001</td>
      <td>0.000001</td>
      <td>1.000000</td>
      <td>06:07</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.000001</td>
      <td>0.000001</td>
      <td>1.000000</td>
      <td>06:00</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>06:08</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.000001</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>06:05</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">learn</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The paper mentions 99.9 % accuracy for this setup - in our case it seems to work perfect.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Reformer-LM---LSH-Attention-and-fewer-hashing-rounds">Reformer LM - LSH Attention and fewer hashing rounds<a class="anchor-link" href="#Reformer-LM---LSH-Attention-and-fewer-hashing-rounds"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We do a test similar to the one above, but just using a single hashing round in LSH.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_hashes</span><span class="o">=</span><span class="mi">1</span>
<span class="n">bucket_size</span> <span class="o">=</span> <span class="mi">64</span>
<span class="k">assert</span> <span class="n">sl</span> <span class="o">%</span> <span class="p">(</span><span class="n">bucket_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">ReformerLM</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">d_ff</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">heads</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_seq_len</span><span class="o">=</span><span class="n">sl</span><span class="p">,</span><span class="n">attn_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                   <span class="n">ff_dropout</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bucket_size</span><span class="o">=</span><span class="n">bucket_size</span><span class="p">,</span> <span class="n">n_hashes</span><span class="o">=</span><span class="n">n_hashes</span><span class="p">,</span> <span class="n">causal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(</span><span class="n">ignore_index</span><span class="o">=-</span><span class="mi">100</span><span class="p">),</span> 
                <span class="n">metrics</span><span class="o">=</span><span class="n">masked_accuracy</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">MaskTargCallback</span><span class="p">()])</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>masked_accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>4.837211</td>
      <td>4.837219</td>
      <td>0.009790</td>
      <td>05:49</td>
    </tr>
    <tr>
      <td>1</td>
      <td>4.323717</td>
      <td>3.518377</td>
      <td>0.196292</td>
      <td>05:59</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.000002</td>
      <td>0.000001</td>
      <td>1.000000</td>
      <td>06:03</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.000044</td>
      <td>0.000007</td>
      <td>1.000000</td>
      <td>06:02</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>06:05</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>06:05</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>06:06</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>06:02</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>06:07</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>06:05</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">learn</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">empty_cache</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The paper mentions 77.9% accuracy for this setup (single hash). In our case we do much better, why?</p>

</div>
</div>
</div>
</div>
 

