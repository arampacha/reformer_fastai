---

title: Model upload to wandb


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/60_model-upload.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/60_model-upload.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">wandb</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>See <a href="https://docs.wandb.ai/artifacts">https://docs.wandb.ai/artifacts</a> for details on artifacts.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Initialise-run">Initialise run<a class="anchor-link" href="#Initialise-run"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Initialise with <code>run id</code>. You can find the run id on the <code>Overview</code> tab for each run, eg. <code>fastai_community/reformer-fastai/3bq3bxv0</code> - use the final part:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">run_id</span> <span class="o">=</span> <span class="s1">&#39;3bq3bxv0&#39;</span>
<span class="n">run</span> <span class="o">=</span> <span class="n">wandb</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s1">&#39;reformer-fastai&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">run_id</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Failed to query for notebook name, you can set it manually with the WANDB_NOTEBOOK_NAME environment variable
<span class="ansi-blue-intense-fg ansi-bold">wandb</span>: Currently logged in as: <span class="ansi-yellow-fg">fastai_community</span> (use `wandb login --relogin` to force relogin)
<span class="ansi-blue-intense-fg ansi-bold">wandb</span>: wandb version 0.10.18 is available!  To upgrade, please run:
<span class="ansi-blue-intense-fg ansi-bold">wandb</span>:  $ pip install wandb --upgrade
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

                Tracking run with wandb version 0.10.13<br/>
                Syncing run <strong style="color:#cdcd00">lm_rev_enwik8_sl-4096_bs-2_n_eps-10_seed-876_grad-accum-8-fp32</strong> to <a href="https://wandb.ai" target="_blank">Weights & Biases</a> <a href="https://docs.wandb.com/integrations/jupyter.html" target="_blank">(Documentation)</a>.<br/>
                Project page: <a href="https://wandb.ai/fastai_community/reformer-fastai" target="_blank">https://wandb.ai/fastai_community/reformer-fastai</a><br/>
                Run page: <a href="https://wandb.ai/fastai_community/reformer-fastai/runs/3bq3bxv0" target="_blank">https://wandb.ai/fastai_community/reformer-fastai/runs/3bq3bxv0</a><br/>
                Run data is saved locally in <code>/home/local/NTU/hgi/git/reformer_fastai/nbs/wandb/run-20210209_145411-3bq3bxv0</code><br/><br/>
            
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Create-a-model-artifact-and-add-the-model-file">Create a model artifact and add the model file<a class="anchor-link" href="#Create-a-model-artifact-and-add-the-model-file"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We use the run_id as name.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">artifact</span> <span class="o">=</span> <span class="n">wandb</span><span class="o">.</span><span class="n">Artifact</span><span class="p">(</span><span class="n">run_id</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
<span class="n">artifact</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span><span class="s1">&#39;../models/lm_rev_lm_rev_enwik8_sl-4096_bs-2_n_eps-10_seed-876_grad-accum-8__26_01_2021_20:05.pth&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;ManifestEntry digest: obkN7Dd6FEn9McRBby3Ltw==&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Log-the-artifact-to-the-run">Log the artifact to the run<a class="anchor-link" href="#Log-the-artifact-to-the-run"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">run</span><span class="o">.</span><span class="n">log_artifact</span><span class="p">(</span><span class="n">artifact</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;wandb.sdk.wandb_artifacts.Artifact at 0x7fe1e0bdc8b0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Finally,-close-the-run">Finally, close the run<a class="anchor-link" href="#Finally,-close-the-run"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">run</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<br/>Waiting for W&B process to finish, PID 575049<br/>Program ended successfully.
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Find user logs for this run at: <code>/home/local/NTU/hgi/git/reformer_fastai/nbs/wandb/run-20210209_145411-3bq3bxv0/logs/debug.log</code>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Find internal logs for this run at: <code>/home/local/NTU/hgi/git/reformer_fastai/nbs/wandb/run-20210209_145411-3bq3bxv0/logs/debug-internal.log</code>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Synced 4 W&B file(s), 0 media file(s), 1 artifact file(s) and 1 other file(s)
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

                    <br/>Synced <strong style="color:#cdcd00">lm_rev_enwik8_sl-4096_bs-2_n_eps-10_seed-876_grad-accum-8-fp32</strong>: <a href="https://wandb.ai/fastai_community/reformer-fastai/runs/3bq3bxv0" target="_blank">https://wandb.ai/fastai_community/reformer-fastai/runs/3bq3bxv0</a><br/>
                
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

