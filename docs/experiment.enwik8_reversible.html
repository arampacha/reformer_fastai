---

title: enwik8 - Reversible


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/13_experiment.enwik8_reversible.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/13_experiment.enwik8_reversible.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.text.all</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">reformer_fastai.tokenizers</span> <span class="kn">import</span> <span class="n">ByteTextTokenizer</span>
<span class="kn">from</span> <span class="nn">reformer_fastai.reformer</span> <span class="kn">import</span> <span class="n">ReversibleLM</span>
<span class="kn">from</span> <span class="nn">reformer_fastai.data</span> <span class="kn">import</span> <span class="n">read_and_prepare_data</span><span class="p">,</span> <span class="n">read_lines</span>
<span class="kn">from</span> <span class="nn">reformer_fastai.metrics</span> <span class="kn">import</span> <span class="n">BPC</span>
<span class="kn">from</span> <span class="nn">reformer_fastai.optimizers</span> <span class="kn">import</span> <span class="n">adafactor</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Experiment-Tracking">Experiment Tracking<a class="anchor-link" href="#Experiment-Tracking"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Make sure you have wandb and are logged in:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load Experiment Tracking with Weights &amp; Biases:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">wandb</span>
<span class="kn">from</span> <span class="nn">fastai.callback.wandb</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">WANDB_NAME</span> <span class="o">=</span> <span class="s1">&#39;enc_lm_enwik8_reversible_af&#39;</span>
<span class="n">GROUP</span> <span class="o">=</span> <span class="s1">&#39;TEST&#39;</span>
<span class="n">NOTES</span> <span class="o">=</span> <span class="s1">&#39;ReversibleLM on enwik8 sl 1024 using irrev blocks&#39;</span>
<span class="n">CONFIG</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">TAGS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lm&#39;</span><span class="p">,</span><span class="s1">&#39;rev&#39;</span><span class="p">,</span><span class="s1">&#39;enwik8&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Initialise wandb logging, pleaes <strong>do not change</strong> <code>project</code> or <code>entity</code> (that that everything gets logged to the same place)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wandb</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">reinit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="s2">&quot;reformer-fastai&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;fastai_community&quot;</span><span class="p">,</span> 
           <span class="n">name</span><span class="o">=</span><span class="n">WANDB_NAME</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">GROUP</span><span class="p">,</span> <span class="n">notes</span><span class="o">=</span><span class="n">NOTES</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">CONFIG</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">TAGS</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Download-and-Unpack-enwik8-Data">Download and Unpack enwik8 Data<a class="anchor-link" href="#Download-and-Unpack-enwik8-Data"> </a></h2><p>Download and unzip enwik8 data</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>wget http://mattmahoney.net/dc/enwik8.zip
<span class="o">!</span>unzip enwik8.zip -d storage/
<span class="o">!</span>ls storage
<span class="o">!</span>head -n <span class="m">10</span> data/enwik8
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Prepare-Data">Prepare Data<a class="anchor-link" href="#Prepare-Data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;text&#39;</span><span class="p">:</span><span class="n">read_lines</span><span class="p">(</span><span class="s1">&#39;storage/enwik8&#39;</span><span class="p">)})</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>&lt;mediawiki xmlns="http://www.mediawiki.org/xml/export-0.3/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mediawiki.org/xml/export-0.3/ http://www.mediawiki.org/xml/export-0.3.xsd" version="0.3" xml:lang="en"&gt;\n</td>
    </tr>
    <tr>
      <th>1</th>
      <td>&lt;siteinfo&gt;\n</td>
    </tr>
    <tr>
      <th>2</th>
      <td>&lt;sitename&gt;Wikipedia&lt;/sitename&gt;\n</td>
    </tr>
    <tr>
      <th>3</th>
      <td>&lt;base&gt;http://en.wikipedia.org/wiki/Main_Page&lt;/base&gt;\n</td>
    </tr>
    <tr>
      <th>4</th>
      <td>&lt;generator&gt;MediaWiki 1.6alpha&lt;/generator&gt;\n</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">btt</span> <span class="o">=</span> <span class="n">ByteTextTokenizer</span><span class="p">(</span><span class="n">is_lm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_bos</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_eos</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;toks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">btt</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;lens&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;toks&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;lens_cum_sum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">lens</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 2min 8s, sys: 3.26 s, total: 2min 11s
Wall time: 2min 7s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_cutoff</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">lens</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="mi">10_000_000</span>  <span class="c1"># keep all but 10M characters for val and test</span>
<span class="n">train_idxs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lens_cum_sum&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">train_cutoff</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
<span class="n">train_idxs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">train_idxs</span><span class="p">)))</span>

<span class="n">remaining_idxs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="nb">max</span><span class="p">(</span><span class="n">train_idxs</span><span class="p">)</span>
<span class="n">validation_idxs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">train_idxs</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">train_idxs</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">remaining_idxs</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">test_idxs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">validation_idxs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)))</span>

<span class="n">splits</span> <span class="o">=</span> <span class="p">[</span><span class="n">train_idxs</span><span class="p">,</span> <span class="n">validation_idxs</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">),</span> <span class="n">btt</span><span class="p">]</span>
<span class="n">dsets</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="n">tfms</span><span class="p">],</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">,</span> <span class="n">dl_type</span><span class="o">=</span><span class="n">LMDataLoader</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">bs</span><span class="p">,</span> <span class="n">sl</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1024</span>
<span class="c1"># pad_seq2seq = partial(pad_input, pad_idx=bte.pad_token_id, pad_fields=[0,1])</span>
<span class="n">dl_kwargs</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;lens&#39;</span><span class="p">:</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lens&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">train_idxs</span><span class="p">]},</span>
             <span class="p">{</span><span class="s1">&#39;val_lens&#39;</span><span class="p">:</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lens&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">validation_idxs</span><span class="p">]}]</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">dsets</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="p">,</span> <span class="n">seq_len</span><span class="o">=</span><span class="n">sl</span><span class="p">,</span> <span class="n">dl_kwargs</span><span class="o">=</span><span class="n">dl_kwargs</span><span class="p">,</span> <span class="n">shuffle_train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 29.2 s, sys: 1.79 s, total: 31 s
Wall time: 36.5 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary data-open="Hide Output" data-close="Show Output"></summary>
        <summary></summary>
        
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>text_</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>**[http://www.gutenberg.net/etext/12073 Letters of Horace Walpole, Volume I]\n*[[Beta rays]]  \nIn the modern comics' canon, years before Clark or Lois began working for the paper, [[Lex Luthor]] owned the ''Daily Planet.'' When Luthor, deciding to sell the paper, began taking bids for the ''Planet'', Perry White convinced an international conglomerate, TransNational Enterprises, to buy the paper. They agreed to this venture with only one stipulation: that Perry White would become editor-in-chief. White has served as the ''Planet'' editor-in-chief ever since, barring the few times he was absent. During those times people such as [[Sam Foswell]] and Clark Kent have looked after the paper. [[Franklin Stern]], an old friend of White's, became the ''Daily Planet'''s publisher.\n\n*Corey Robin (2004), ''Fear: the history of a political idea'', Oxford University Press\n[[es:Bernardo de Claraval]]\n| regnum = [[Animal]]ia\n{{main|Carbohydrate}}\n[[sv:David Hume]]\n[[hr:Domicijan]]\n== Pop and Rock == \n[[Category:Alice charact</td>
      <td>*[http://www.gutenberg.net/etext/12073 Letters of Horace Walpole, Volume I]\n*[[Beta rays]]  \nIn the modern comics' canon, years before Clark or Lois began working for the paper, [[Lex Luthor]] owned the ''Daily Planet.'' When Luthor, deciding to sell the paper, began taking bids for the ''Planet'', Perry White convinced an international conglomerate, TransNational Enterprises, to buy the paper. They agreed to this venture with only one stipulation: that Perry White would become editor-in-chief. White has served as the ''Planet'' editor-in-chief ever since, barring the few times he was absent. During those times people such as [[Sam Foswell]] and Clark Kent have looked after the paper. [[Franklin Stern]], an old friend of White's, became the ''Daily Planet'''s publisher.\n\n*Corey Robin (2004), ''Fear: the history of a political idea'', Oxford University Press\n[[es:Bernardo de Claraval]]\n| regnum = [[Animal]]ia\n{{main|Carbohydrate}}\n[[sv:David Hume]]\n[[hr:Domicijan]]\n== Pop and Rock == \n[[Category:Alice characte</td>
    </tr>
    <tr>
      <th>1</th>
      <td>]]. The name &amp;amp;#8220;H.G. Wells&amp;amp;#8221; appeared high on the list for the &amp;quot;crime&amp;quot; of being a socialist. Wells, as president of the International [[PEN]] (Poets, Essayists, Novelists), had already angered the [[Nazism|Nazis]] by overseeing the expulsion of the German PEN club from the international body in 1934 following the German PEN's refusal to admit non-[[Aryan]] writers to its membership.\n    &lt;id&gt;11064&lt;/id&gt;\n[[es:Hipertiroidismo]]\n[[Category:Open source licenses]]\n\n[[de:Buch Nehemia]]\n\n\n\n      &lt;text xml:space="preserve"&gt;{{expert}}\nIn the [[politics of the European Union]], any decision taken using the [[codecision procedure]] requires an absolute majority in [[European Parliament]] in order to amend a text in its second reading. (At first reading, only a [[simple majority]] is required.)\n      &lt;/contributor&gt;\n* [[Eurovision Song Contest 1985]]\n** [[CMX (comics)|CMX]]\n  &lt;/page&gt;\nEdinburgh Multi Access System&amp;lt;br&amp;gt;\n*[[1886]] - [[Hugo Ball]], German author and poet (d. [[1927]])\n==Examples=</td>
      <td>]. The name &amp;amp;#8220;H.G. Wells&amp;amp;#8221; appeared high on the list for the &amp;quot;crime&amp;quot; of being a socialist. Wells, as president of the International [[PEN]] (Poets, Essayists, Novelists), had already angered the [[Nazism|Nazis]] by overseeing the expulsion of the German PEN club from the international body in 1934 following the German PEN's refusal to admit non-[[Aryan]] writers to its membership.\n    &lt;id&gt;11064&lt;/id&gt;\n[[es:Hipertiroidismo]]\n[[Category:Open source licenses]]\n\n[[de:Buch Nehemia]]\n\n\n\n      &lt;text xml:space="preserve"&gt;{{expert}}\nIn the [[politics of the European Union]], any decision taken using the [[codecision procedure]] requires an absolute majority in [[European Parliament]] in order to amend a text in its second reading. (At first reading, only a [[simple majority]] is required.)\n      &lt;/contributor&gt;\n* [[Eurovision Song Contest 1985]]\n** [[CMX (comics)|CMX]]\n  &lt;/page&gt;\nEdinburgh Multi Access System&amp;lt;br&amp;gt;\n*[[1886]] - [[Hugo Ball]], German author and poet (d. [[1927]])\n==Examples==</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

    </details>
</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_sz</span> <span class="o">=</span> <span class="n">btt</span><span class="o">.</span><span class="n">vocab_size</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">xb</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">yb</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([8, 1024]), torch.Size([8, 1024]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training">Training<a class="anchor-link" href="#Training"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wandb</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">reinit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="s2">&quot;reformer-fastai&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;fastai_community&quot;</span><span class="p">,</span> 
           <span class="n">name</span><span class="o">=</span><span class="n">WANDB_NAME</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">GROUP</span><span class="p">,</span> <span class="n">notes</span><span class="o">=</span><span class="n">NOTES</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">TAGS</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">CONFIG</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt_func</span> <span class="o">=</span> <span class="n">adafactor</span>

<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">ReversibleLM</span><span class="p">(</span><span class="n">vocab_sz</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_seq_len</span><span class="o">=</span><span class="n">sl</span><span class="p">,</span> <span class="n">rev_thres</span><span class="o">=</span><span class="mi">1025</span><span class="p">),</span> <span class="c1">#using irrev blocks for speed</span>
                <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">opt_func</span><span class="p">,</span>
                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">perplexity</span><span class="p">,</span> <span class="n">BPC</span><span class="p">()],</span>
                <span class="n">cbs</span><span class="o">=</span><span class="n">TerminateOnNaNCallback</span><span class="p">())</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">WandbCallback</span><span class="p">(</span><span class="n">log_model</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_preds</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='1' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      33.33% [1/3 1:10:46<2:21:33]
    </div>
    
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>perplexity</th>
      <th>bpc</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.444021</td>
      <td>1.389910</td>
      <td>0.592767</td>
      <td>4.014487</td>
      <td>0.963412</td>
      <td>1:10:46</td>
    </tr>
  </tbody>
</table><p>

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='8136' class='' max='10987' style='width:300px; height:20px; vertical-align: middle;'></progress>
      74.05% [8136/10987 50:59<17:51 1.3544]
    </div>
    
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Buffered data was truncated after reaching the output size limit.</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

