---

title: enwik8 - shared QK


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/12_experiment.enwik8_sharedQK.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/12_experiment.enwik8_sharedQK.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.text.all</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">reformer_fastai.tokenizers</span> <span class="kn">import</span> <span class="n">ByteTextTokenizer</span>
<span class="kn">from</span> <span class="nn">reformer_fastai.transformer</span> <span class="kn">import</span> <span class="n">TransformerLM</span>
<span class="kn">from</span> <span class="nn">reformer_fastai.data</span> <span class="kn">import</span> <span class="n">read_and_prepare_data</span><span class="p">,</span> <span class="n">read_lines</span>
<span class="kn">from</span> <span class="nn">reformer_fastai.metrics</span> <span class="kn">import</span> <span class="n">BPC</span>
<span class="kn">from</span> <span class="nn">reformer_fastai.optimizers</span> <span class="kn">import</span> <span class="n">adafactor</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Experiment-Tracking">Experiment Tracking<a class="anchor-link" href="#Experiment-Tracking"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Make sure you have wandb and are logged in:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load Experiment Tracking with Weights &amp; Biases:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">wandb</span>
<span class="kn">from</span> <span class="nn">fastai.callback.wandb</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">WANDB_NAME</span> <span class="o">=</span> <span class="s1">&#39;enc_lm_enwik8_shared_qk&#39;</span>
<span class="n">GROUP</span> <span class="o">=</span> <span class="s1">&#39;TEST&#39;</span>
<span class="n">NOTES</span> <span class="o">=</span> <span class="s1">&#39;TransformerLM on enwik8 sl 1024 w/ sharedQK&#39;</span>
<span class="n">CONFIG</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">TAGS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;lm&#39;</span><span class="p">,</span><span class="s1">&#39;shared_qk&#39;</span><span class="p">,</span><span class="s1">&#39;enwik8&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Initialise wandb logging, pleaes <strong>do not change</strong> <code>project</code> or <code>entity</code> (that that everything gets logged to the same place)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wandb</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">reinit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="s2">&quot;reformer-fastai&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;fastai_community&quot;</span><span class="p">,</span> 
           <span class="n">name</span><span class="o">=</span><span class="n">WANDB_NAME</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">GROUP</span><span class="p">,</span> <span class="n">notes</span><span class="o">=</span><span class="n">NOTES</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">CONFIG</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">TAGS</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Download-and-Unpack-enwik8-Data">Download and Unpack enwik8 Data<a class="anchor-link" href="#Download-and-Unpack-enwik8-Data"> </a></h2><p>Download and unzip enwik8 data</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>wget -P data/ http://mattmahoney.net/dc/enwik8.zip
<span class="o">!</span>unzip data/enwik8.zip -d data/
<span class="o">!</span>ls data
<span class="o">!</span>head -n <span class="m">10</span> data/enwik8
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Prepare-Data">Prepare Data<a class="anchor-link" href="#Prepare-Data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;text&#39;</span><span class="p">:</span><span class="n">read_lines</span><span class="p">(</span><span class="s1">&#39;/content/data/enwik8&#39;</span><span class="p">)})</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>&lt;mediawiki xmlns="http://www.mediawiki.org/xml/export-0.3/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mediawiki.org/xml/export-0.3/ http://www.mediawiki.org/xml/export-0.3.xsd" version="0.3" xml:lang="en"&gt;\n</td>
    </tr>
    <tr>
      <th>1</th>
      <td>&lt;siteinfo&gt;\n</td>
    </tr>
    <tr>
      <th>2</th>
      <td>&lt;sitename&gt;Wikipedia&lt;/sitename&gt;\n</td>
    </tr>
    <tr>
      <th>3</th>
      <td>&lt;base&gt;http://en.wikipedia.org/wiki/Main_Page&lt;/base&gt;\n</td>
    </tr>
    <tr>
      <th>4</th>
      <td>&lt;generator&gt;MediaWiki 1.6alpha&lt;/generator&gt;\n</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">btt</span> <span class="o">=</span> <span class="n">ByteTextTokenizer</span><span class="p">(</span><span class="n">is_lm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_bos</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_eos</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;toks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">btt</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;lens&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;toks&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;lens_cum_sum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">lens</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 2min 3s, sys: 4.37 s, total: 2min 7s
Wall time: 2min 1s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_cutoff</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">lens</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">-</span> <span class="mi">10_000_000</span>  <span class="c1"># keep all but 10M characters for val and test</span>
<span class="n">train_idxs</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lens_cum_sum&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">train_cutoff</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
<span class="n">train_idxs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">train_idxs</span><span class="p">)))</span>

<span class="n">remaining_idxs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="nb">max</span><span class="p">(</span><span class="n">train_idxs</span><span class="p">)</span>
<span class="n">validation_idxs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">train_idxs</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">train_idxs</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">remaining_idxs</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">test_idxs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">validation_idxs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)))</span>

<span class="n">splits</span> <span class="o">=</span> <span class="p">[</span><span class="n">train_idxs</span><span class="p">,</span> <span class="n">validation_idxs</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">),</span> <span class="n">btt</span><span class="p">]</span>
<span class="n">dsets</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="p">[</span><span class="n">tfms</span><span class="p">],</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">,</span> <span class="n">dl_type</span><span class="o">=</span><span class="n">LMDataLoader</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">bs</span><span class="p">,</span> <span class="n">sl</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1024</span>
<span class="c1"># pad_seq2seq = partial(pad_input, pad_idx=bte.pad_token_id, pad_fields=[0,1])</span>
<span class="n">dl_kwargs</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;lens&#39;</span><span class="p">:</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lens&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">train_idxs</span><span class="p">]},</span>
             <span class="p">{</span><span class="s1">&#39;val_lens&#39;</span><span class="p">:</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lens&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">validation_idxs</span><span class="p">]}]</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">dsets</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="n">bs</span><span class="p">,</span> <span class="n">seq_len</span><span class="o">=</span><span class="n">sl</span><span class="p">,</span> <span class="n">dl_kwargs</span><span class="o">=</span><span class="n">dl_kwargs</span><span class="p">,</span> <span class="n">shuffle_train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 27.1 s, sys: 1.83 s, total: 29 s
Wall time: 34.7 s
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">(</span><span class="n">max_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,)</span>
</pre></div>

    </div>
</div>
</div>
<details class="description">
      <summary data-open="Hide Output" data-close="Show Output"></summary>
        <summary></summary>
        
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>text_</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>&lt;page&gt;\nFailure of a condition does not void the contract, it is just regarded as voidable.\n!colspan=2 align=center bgcolor=&amp;quot;#BFDFFF&amp;quot;|Urban Area \n*[http://www.tohokingdom.com/web_pages/m_reviews/vega/return_godzilla_us.htm Toho Kingdom]: ''The Return of Godzilla'' (1984) [New World Pictures].  Reviewer: Miles Imhoff.\n*[[John Irving]]\n    &lt;restrictions&gt;move=:edit=&lt;/restrictions&gt;\n[[et:Bangladesh]]\n:&amp;lt;math&amp;gt; \Pi(n; \phi|m) = \int_0^u \frac{1}{1-n \textrm{sn}^2 (w|m)} \; dw&amp;lt;/math&amp;gt;\n\n      &lt;minor /&gt;\n{{Infobox_Poland|\n*[[1945]] - [[Peter Criss|Peter George Criscoula]], American drummer and singer ([[KISS (band)]])\n\n\n*Pratchett, Terry (1993). ''[[Men At Arms]]''. Gollancz.\n|colspan=2| &amp;amp;nbsp;\n&amp;lt;/div&amp;gt;\n'''Cyberpunk''' (a [[portmanteau]] of [[cybernetics]] and [[punk culture|punk]]) is a sub-genre of [[science fiction]] and [[dystopia]]n fiction, focusing on advanced technology such as [[computers]] or [[information technology]] coupled with some degree of breakdown in the social order. The</td>
      <td>&lt;page&gt;\nFailure of a condition does not void the contract, it is just regarded as voidable.\n!colspan=2 align=center bgcolor=&amp;quot;#BFDFFF&amp;quot;|Urban Area \n*[http://www.tohokingdom.com/web_pages/m_reviews/vega/return_godzilla_us.htm Toho Kingdom]: ''The Return of Godzilla'' (1984) [New World Pictures].  Reviewer: Miles Imhoff.\n*[[John Irving]]\n    &lt;restrictions&gt;move=:edit=&lt;/restrictions&gt;\n[[et:Bangladesh]]\n:&amp;lt;math&amp;gt; \Pi(n; \phi|m) = \int_0^u \frac{1}{1-n \textrm{sn}^2 (w|m)} \; dw&amp;lt;/math&amp;gt;\n\n      &lt;minor /&gt;\n{{Infobox_Poland|\n*[[1945]] - [[Peter Criss|Peter George Criscoula]], American drummer and singer ([[KISS (band)]])\n\n\n*Pratchett, Terry (1993). ''[[Men At Arms]]''. Gollancz.\n|colspan=2| &amp;amp;nbsp;\n&amp;lt;/div&amp;gt;\n'''Cyberpunk''' (a [[portmanteau]] of [[cybernetics]] and [[punk culture|punk]]) is a sub-genre of [[science fiction]] and [[dystopia]]n fiction, focusing on advanced technology such as [[computers]] or [[information technology]] coupled with some degree of breakdown in the social order. The p</td>
    </tr>
    <tr>
      <th>1</th>
      <td>nitrogen oxides.  Incomplete combustion is much more common  and will produce large amounts of byproducts, and in the case of burning fuel in automobiles, these byproducts can be quite lethal and damaging to the environment.\n    &lt;title&gt;Military of Guyana&lt;/title&gt;\n== Sponsorship ==\n      &lt;/contributor&gt;\n[[Paul Atreides]] had two children, [[Leto Atreides II|Leto]] and [[Ghanima]].  At the end of ''[[Dune Messiah]]'', Paul walked into the desert, a blind man, leaving the children in the care of the [[Fremen]] while their aunt [[Alia Atreides|Alia]] rules the universe as regent.  Awoken in the womb by the spice, the children are the heirs to Paul's [[Prescience|prescient]] vision of the fate of the universe, a role that Alia desperately craves.  [[House Corrino]], the previous imperial house, schemes to return to the throne, while the [[Bene Gesserit]] make common cause with the [[Bene Tleilaxu]] and [[Spacing</td>
      <td>nitrogen oxides.  Incomplete combustion is much more common  and will produce large amounts of byproducts, and in the case of burning fuel in automobiles, these byproducts can be quite lethal and damaging to the environment.\n    &lt;title&gt;Military of Guyana&lt;/title&gt;\n== Sponsorship ==\n      &lt;/contributor&gt;\n[[Paul Atreides]] had two children, [[Leto Atreides II|Leto]] and [[Ghanima]].  At the end of ''[[Dune Messiah]]'', Paul walked into the desert, a blind man, leaving the children in the care of the [[Fremen]] while their aunt [[Alia Atreides|Alia]] rules the universe as regent.  Awoken in the womb by the spice, the children are the heirs to Paul's [[Prescience|prescient]] vision of the fate of the universe, a role that Alia desperately craves.  [[House Corrino]], the previous imperial house, schemes to return to the throne, while the [[Bene Gesserit]] make common cause with the [[Bene Tleilaxu]] and [[Spacing Guild]]</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

    </details>
</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_sz</span> <span class="o">=</span> <span class="n">btt</span><span class="o">.</span><span class="n">vocab_size</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">xb</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">yb</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((8, 1024), (8, 1024))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training">Training<a class="anchor-link" href="#Training"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wandb</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">reinit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="s2">&quot;reformer-fastai&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="o">=</span><span class="s2">&quot;fastai_community&quot;</span><span class="p">,</span> 
           <span class="n">name</span><span class="o">=</span><span class="n">WANDB_NAME</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="n">GROUP</span><span class="p">,</span> <span class="n">notes</span><span class="o">=</span><span class="n">NOTES</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">TAGS</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">CONFIG</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-blue-intense-fg ansi-bold">wandb</span>: Currently logged in as: <span class="ansi-yellow-fg">fastai_community</span> (use `wandb login --relogin` to force relogin)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

                Tracking run with wandb version 0.10.12<br/>
                Syncing run <strong style="color:#cdcd00">enc_lm_enwik8_shared_qk</strong> to <a href="https://wandb.ai" target="_blank">Weights & Biases</a> <a href="https://docs.wandb.com/integrations/jupyter.html" target="_blank">(Documentation)</a>.<br/>
                Project page: <a href="https://wandb.ai/fastai_community/reformer-fastai" target="_blank">https://wandb.ai/fastai_community/reformer-fastai</a><br/>
                Run page: <a href="https://wandb.ai/fastai_community/reformer-fastai/runs/1egf4gn5" target="_blank">https://wandb.ai/fastai_community/reformer-fastai/runs/1egf4gn5</a><br/>
                Run data is saved locally in <code>/content/wandb/run-20201228_170831-1egf4gn5</code><br/><br/>
            
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<h1>Run(1egf4gn5)</h1><p></p><iframe src="https://wandb.ai/fastai_community/reformer-fastai/runs/1egf4gn5" style="border:none;width:100%;height:400px"></iframe>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt_func</span> <span class="o">=</span> <span class="n">adafactor</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">TransformerLM</span><span class="p">(</span><span class="n">vocab_sz</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_seq_len</span><span class="o">=</span><span class="n">sl</span><span class="p">,</span> <span class="n">shared_qk</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">opt_func</span><span class="p">,</span>
                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">perplexity</span><span class="p">,</span> <span class="n">BPC</span><span class="p">()])</span><span class="o">.</span><span class="n">to_native_fp16</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">5e-4</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">WandbCallback</span><span class="p">(</span><span class="n">log_model</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_preds</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>perplexity</th>
      <th>bpc</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.730407</td>
      <td>1.589415</td>
      <td>0.538215</td>
      <td>4.900879</td>
      <td>1.101698</td>
      <td>1:09:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.411922</td>
      <td>1.349798</td>
      <td>0.602156</td>
      <td>3.856645</td>
      <td>0.935608</td>
      <td>1:09:01</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1.354414</td>
      <td>1.296836</td>
      <td>0.616557</td>
      <td>3.657704</td>
      <td>0.898898</td>
      <td>1:09:09</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">recorder</span><span class="o">.</span><span class="n">plot_loss</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

